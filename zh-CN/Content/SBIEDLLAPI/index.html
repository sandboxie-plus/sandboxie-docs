
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="本页面描述了 SbieDll.dll 动态链接库（DLL）中可调用的入口点。这些入口点暴露了沙箱工具（Sandboxie）的一些功能，这些功能可以通过编程方式访问，即通过其他程序而非用户与沙箱工具进行交互来访问。">
      
      
      
        <link rel="canonical" href="https://sandboxie-plus.github.io/sandboxie-docs/zh-CN/Content/SBIEDLLAPI/">
      
      
        <link rel="prev" href="../SBIEMessages/">
      
      
        <link rel="next" href="../SBIE1101/">
      
      
      <link rel="icon" href="../../../material/assets/images/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21">
    
    
      
        <title>SBIE DLL API - Sandboxie 文档</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.2a3383ac.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
    
    
      <link rel="stylesheet" href="../../../material/assets/stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sbie-dll-api" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="Sandboxie 文档" class="md-header__button md-logo" aria-label="Sandboxie 文档" data-md-component="logo">
      
  <img src="../../../Media/SandDocs.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Sandboxie 文档
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              SBIE DLL API
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="选择当前语言">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="../../../Content/SBIEDLLAPI/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="./" hreflang="zh" class="md-select__link">
              简体中文
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="分享" aria-label="分享" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/sandboxie-plus/Sandboxie" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    sandboxie-plus/Sandboxie
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Sandboxie 文档" class="md-nav__button md-logo" aria-label="Sandboxie 文档" data-md-component="logo">
      
  <img src="../../../Media/SandDocs.png" alt="logo">

    </a>
    Sandboxie 文档
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/sandboxie-plus/Sandboxie" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    sandboxie-plus/Sandboxie
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Sandboxie 基础知识
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Sandboxie 基础知识
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HelpTopics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    帮助主题
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../GettingStarted/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    入门指南
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_3" >
        
          
          <label class="md-nav__link" for="__nav_1_3" id="__nav_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Sandboxie 控制
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_3">
            <span class="md-nav__icon md-icon"></span>
            Sandboxie 控制
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SandboxieControl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    沙盘控制面板
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../FileMenu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    文件菜单
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ViewMenu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    视图菜单
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SandboxMenu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    沙盘菜单
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ConfigureMenu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    配置菜单
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HelpMenu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    帮助菜单
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../TrayIconMenu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    系统托盘图标菜单
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../UsageTips/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    使用技巧
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5" >
        
          
          <label class="md-nav__link" for="__nav_1_5" id="__nav_1_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    命令行用法
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5">
            <span class="md-nav__icon md-icon"></span>
            命令行用法
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../StartCommandLine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    启动命令行
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SandboxieIni/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    沙盘配置文件（Sandboxie.ini）
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../KnownConflicts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    已知冲突
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Sandboxie Plus
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Sandboxie Plus
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PlusMigrationGuide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    沙盘增强版（Sandboxie Plus）迁移指南
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../PlusContent/Plus-Features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Plus Features
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    高级主题
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            高级主题
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../AdvancedTopics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    高级主题
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SandboxHierarchy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    沙箱层级
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PrivacyConcerns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    隐私问题
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ServicePrograms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    服务程序
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ResourceAccessMonitor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    资源访问监视器（适用于沙盘经典版）
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../PlusContent/TraceLog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    跟踪日志（适用于 Sandboxie Plus）
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HowToUseWinDbg/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    如何使用 WinDbg
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_8" checked>
        
          
          <label class="md-nav__link" for="__nav_4_8" id="__nav_4_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    SBIE 消息
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_8">
            <span class="md-nav__icon md-icon"></span>
            SBIE 消息
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIEMessages/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE 消息
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    SBIE DLL API
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    SBIE DLL API
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      枚举沙箱名称
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      按沙箱名称查询沙箱路径
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#id" class="md-nav__link">
    <span class="md-ellipsis">
      按进程 ID 查询沙箱路径
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      枚举正在运行的进程
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      查询进程信息
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      终止单个沙箱进程
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      终止所有沙箱进程
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sandboxieini" class="md-nav__link">
    <span class="md-ellipsis">
      从 Sandboxie.ini 查询配置
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sandboxieini_1" class="md-nav__link">
    <span class="md-ellipsis">
      更新 Sandboxie.ini 中的配置
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sandboxieini_2" class="md-nav__link">
    <span class="md-ellipsis">
      从 Sandboxie.ini 重新加载配置
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      挂钩用户模式入口点
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dll" class="md-nav__link">
    <span class="md-ellipsis">
      注册 DLL 加载/卸载回调
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sandboxie" class="md-nav__link">
    <span class="md-ellipsis">
      获取 Sandboxie 主文件夹
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1101/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1101
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1102/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1102
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1103/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1103
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1104/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1104
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1105/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1105
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1106/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1106
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1108/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1108
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1109/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1109
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1110/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1110
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1111/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1111
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1112/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1112
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1113/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1113
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1114/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1114
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1116/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1116
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1119/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1119
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1120/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1120
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1121/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1121
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1122/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1122
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1151/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1151
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1152/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1152
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1153/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1153
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1201/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1201
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1202/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1202
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1203/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1203
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1204/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1204
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1211/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1211
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1212/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1212
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1213/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1213
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1214/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1214
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1215/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1215
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1216/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1216
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1222/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1222
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1223/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1223
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1224/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1224
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1241/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1241
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1242/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1242
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1301/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1301
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1303/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1303
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1304/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1304
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1306/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1306
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1307/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1307
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1308/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1308
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1309/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1309
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1310/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1310
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1311/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1311
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1312/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1312
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1313/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1313
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1314/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1314
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1401/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1401
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1402/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1402
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1403/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1403
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1404/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1404
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1405/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1405
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1406/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1406
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1408/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1408
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1409/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1409
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1410/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1410
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1411/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1411
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE1412/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE1412
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2102/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2102
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2103/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2103
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2104/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2104
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2108/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2108
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2111/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2111
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2191/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2191
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2192/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2192
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2193/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2193
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2202/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2202
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2203/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2203
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2204/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2204
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2205/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2205
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2206/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2206
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2207/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2207
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2208/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2208
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2209/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2209
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2210/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2210
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2211/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2211
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2212/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2212
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2213/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2213
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2214/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2214
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2217/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2217
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2218/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2218
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2219/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2219
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2220/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2220
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2221/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2221
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2222/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2222
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2223/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2223
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2303/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2303
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2304/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2304
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2305/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2305
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2306/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2306
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2307/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2307
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2308/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2308
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2309/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2309
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2310/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2310
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2311/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2311
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2312/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2312
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2313/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2313
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2314/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2314
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2315/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2315
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2316/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2316
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2317/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2317
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2318/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2318
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2321/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2321
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2322/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2322
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2323/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2323
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2326/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2326
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2327/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2327
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2331/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2331
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2332/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2332
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE2334/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE2334
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE3207/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE3207
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE3208/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE3208
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE3209/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE3209
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE9101/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE9101
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE9153/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE9153
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE9154/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE9154
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE9156/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE9156
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE9201/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE9201
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE9202/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE9202
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE9203/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE9203
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE9204/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE9204
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE9205/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE9205
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE9206/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE9206
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE9207/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE9207
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE9208/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE9208
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE9251/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE9251
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE9252/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE9252
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE9253/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE9253
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE9302/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE9302
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE9304/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE9304
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SBIE9305/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SBIE9305
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../TechnicalAspects/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    技术细节
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/sandboxie-plus/sandboxie-docs/edit/main/docs/zh-CN/Content/SBIEDLLAPI.md" title="编辑此页" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/sandboxie-plus/sandboxie-docs/raw/main/docs/zh-CN/Content/SBIEDLLAPI.md" title="查看本页的源代码" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="sbie-dll-api">SBIE DLL API<a class="headerlink" href="#sbie-dll-api" title="Permanent link"></a></h1>
<p>本页面描述了 <em>SbieDll.dll</em> 动态链接库（DLL）中可调用的入口点。这些入口点暴露了沙箱工具（Sandboxie）的一些功能，这些功能可以通过编程方式访问，即通过其他程序而非用户与沙箱工具进行交互来访问。</p>
<p>以编程方式使用沙箱工具涉及三个方面：</p>
<ul>
<li>使用 Start.exe 程序驱动某些功能。请参阅 <a href="../StartCommandLine/">Start 命令行</a>。</li>
<li>将自定义 DLL 注入到沙箱程序中。请参阅 <a href="../InjectDll/">InjectDll</a>。</li>
<li>从正在运行的程序（无论是否在沙箱中）调用沙箱工具的入口点。本文将对此进行描述。</li>
</ul>
<p>本文描述的入口点均由 <em>SbieDll.dll</em> 导出。要访问某个入口点，你应该将此 DLL 动态加载到你的程序中，并获取所需入口点的地址。例如：</p>
<pre><code class="language-C">        __declspec(dllexport) void __stdcall InjectDllMain(HINSTANCE hSbieDll, ULONG_PTR UnusedParameter)
    {
        //
            // 定位 SbieDll.dll 中 SbieDll_Hook 的地址
            //

            typedef void *(__stdcall *P_SbieDll_Hook)(
                    const char *ApiName, void *ApiFunc, void *NewFunc);

            P_SbieDll_Hook p_SbieDll_Hook = GetProcAddress(hSbieDll, &quot;SbieDll_Hook&quot;);

        //
            // 通过函数指针调用 SbieDll_Hook
            //

            p_SbieDll_Hook(...);
    }
</code></pre>
<p>请注意使用 <em>InjectDllMain</em>（请参阅 <a href="../InjectDll/">注入 DLL</a>）来获取已加载的 SbieDll 实例的句柄。这是推荐的方法。不过，使用 LoadLibrary 或 GetModuleHandle 按名称查找 SbieDll 也是可行的。</p>
<hr />
<h3 id="_1">枚举沙箱名称<a class="headerlink" href="#_1" title="Permanent link"></a></h3>
<ul>
<li>原型：</li>
</ul>
<pre><code class="language-C">        typedef LONG (__stdcall *P_SbieApi_EnumBoxes)(
                LONG index,                 // 初始化为 -1
                WCHAR *box_name);            // 指向 WCHAR [34] 的指针
</code></pre>
<ul>
<li>导出名称：</li>
</ul>
<pre><code>        SbieApi_EnumBoxes
</code></pre>
<ul>
<li>参数：</li>
</ul>
<pre><code>        index [in] 指定要返回的沙箱。初始化为 -1。
        沙箱按照它们在 Sandboxie.ini 中出现的顺序进行枚举。

        box_name [out] 接收沙箱名称。

        注意：此函数不能由沙箱程序使用。
</code></pre>
<ul>
<li>返回值：</li>
</ul>
<pre><code>        返回下一次用于 index 参数的值。
        当没有更多内容需要枚举时返回 -1。
</code></pre>
<ul>
<li>示例代码：</li>
</ul>
<pre><code class="language-C">        WCHAR name[34];
        int index = -1;
        while (1) {
                index = SbieApi_EnumBoxes(index, name);
                if (index == -1)
                    break;
                SandboxNames_StringArray.add(name);
        }
</code></pre>
<hr />
<h3 id="_2">按沙箱名称查询沙箱路径<a class="headerlink" href="#_2" title="Permanent link"></a></h3>
<ul>
<li>原型：</li>
</ul>
<pre><code class="language-C">        typedef LONG (__stdcall *P_SbieApi_QueryBoxPath)(
                const WCHAR *box_name,      // 指向 WCHAR [34] 的指针
                WCHAR *file_path,
                WCHAR *key_path,
                WCHAR *ipc_path,
                ULONG *file_path_len,
                ULONG *key_path_len,
                ULONG *ipc_path_len);
</code></pre>
<ul>
<li>导出名称：</li>
</ul>
<pre><code>        SbieApi_QueryBoxPath
</code></pre>
<ul>
<li>参数：</li>
</ul>
<pre><code>        box_name [in] 指定要返回路径信息的沙箱名称。

        file_path [out] 接收沙箱根目录的路径，该路径由 FileRootPath 设置指定。
        该缓冲区最多接收 file_path_len 参数指定的字节数。传入 NULL 以忽略此参数。

        key_path [out] 接收沙箱注册表根键的路径，该路径由 KeyRootPath 设置指定。
        该缓冲区最多接收 key_path_len 参数指定的字节数。传入 NULL 以忽略此参数。

        ipc_path [out] 接收沙箱根对象目录的路径，该路径由 IpcRootPath 设置指定。
        该缓冲区最多接收 ipc_path_len 参数指定的字节数。传入 NULL 以忽略此参数。

        file_path_len [in/out] 指定 file_path 缓冲区的字节长度。返回时，接收完整缓冲区所需的字节长度。

        key_path_len [in/out] 指定 key_path 缓冲区的字节长度。返回时，接收完整缓冲区所需的字节长度。

        ipc_path_len [in/out] 指定 ipc_path 缓冲区的字节长度。返回时，接收完整缓冲区所需的字节长度。
</code></pre>
<ul>
<li>返回值：</li>
</ul>
<pre><code>        成功时返回零，出错时返回非零值。
</code></pre>
<ul>
<li>示例代码：</li>
</ul>
<pre><code class="language-C">        ULONG FileLen = 0;
        ULONG KeyLen  = 0;
        ULONG IpcLen  = 0;

        SbieApi_QueryBoxPath(
                NULL, NULL, NULL, NULL, &amp;FileLen, &amp;KeyLen, &amp;IpcLen);

        // 注意，长度是以字节数返回的，而不是 WCHAR 字符数

        WCHAR *FileBuf = malloc(FileLen);
        WCHAR *KeyBuf = malloc(KeyLen);
        WCHAR *IpcBuf = malloc(IpcLen);

        SbieApi_QueryBoxPath(
                FileBuf, KeyBuf, IpcBuf, &amp;FileLen, &amp;KeyLen, &amp;IpcLen);

        // 现在使用 wcslen 来计算字符数

        FileLen = wcslen(FileBuf);
        KeyLen  = wcslen(KeyBuf);
        IpcLen  = wcslen(IpcBuf);
</code></pre>
<hr />
<h3 id="id">按进程 ID 查询沙箱路径<a class="headerlink" href="#id" title="Permanent link"></a></h3>
<ul>
<li>原型：</li>
</ul>
<pre><code class="language-C">        typedef LONG (__stdcall *P_SbieApi_QueryProcessPath)(
                HANDLE process_id,
                WCHAR *file_path,
                WCHAR *key_path,
                WCHAR *ipc_path,
                ULONG *file_path_len,
                ULONG *key_path_len,
                ULONG *ipc_path_len);
</code></pre>
<ul>
<li>导出名称：</li>
</ul>
<pre><code>        SbieApi_QueryProcessPath
</code></pre>
<ul>
<li>参数：</li>
</ul>
<pre><code>        process_id [in] 指定要查询的沙箱进程的 ID。

        file_path [out]

        key_path [out]

        ipc_path [out]

        file_path_len [in/out]

        key_path_len [in/out]

        ipc_path_len [in/out]

        最后六个参数与上面讨论的 QueryBoxPath 函数的最后六个参数类似。
        然而，QueryProcessPath（此函数）返回正在运行的程序所使用的沙箱路径，而 QueryBoxPath 返回沙箱配置中记录的路径。

        换句话说：假设一个沙箱程序以 PID 124 启动，然后某个沙箱路径（例如 FileRootPath）被设置为新值。
        此时，QueryBoxPath 将返回新值，但 PID 124 的 QueryProcessPath 将返回旧值。
</code></pre>
<ul>
<li>返回值：</li>
</ul>
<pre><code>        成功时返回零，出错时返回非零值。
</code></pre>
<hr />
<h3 id="_3">枚举正在运行的进程<a class="headerlink" href="#_3" title="Permanent link"></a></h3>
<ul>
<li>原型：</li>
</ul>
<pre><code class="language-C">        typedef LONG (__stdcall *P_SbieApi_EnumProcessEx)(
                const WCHAR *box_name,      // 指向 WCHAR [34] 的指针
                BOOLEAN all_sessions,
                ULONG which_session,
                ULONG *boxed_pids,         // 指向 ULONG [] 的指针
                ULONG *boxed_count);
</code></pre>
<ul>
<li>导出名称：</li>
</ul>
<pre><code>        SbieApi_EnumProcessEx
</code></pre>
<ul>
<li>参数：</li>
</ul>
<pre><code>        box_name [in] 指定要枚举其中进程的沙箱名称。

        all_sessions [in] 指定为 TRUE 以枚举所有登录会话中的进程，或仅枚举特定登录会话中的进程。

        which_session [in] 指定要枚举其中进程的登录会话编号。如果 all_sessions 为 TRUE，则忽略此参数。传入值 -1 以指定当前登录会话。

        boxed_pids [out] 接收进程 ID（PID）编号。
        第一个 ULONG 接收枚举的进程数。
        第二个 ULONG 接收第一个 PID，第三个 ULONG 接收第二个 PID，依此类推。
</code></pre>
<ul>
<li>返回值：</li>
</ul>
<pre><code>       成功时返回零，出错时返回非零值。
</code></pre>
<hr />
<h3 id="_4">查询进程信息<a class="headerlink" href="#_4" title="Permanent link"></a></h3>
<ul>
<li>原型：</li>
</ul>
<pre><code class="language-C">        typedef LONG (__stdcall *P_SbieApi_QueryProcess)(
                HANDLE process_id,
                WCHAR *box_name,            // 指向 WCHAR [34] 的指针
                WCHAR *image_name,          // 指向 WCHAR [96] 的指针
                WCHAR *sid_string,         // 指向 WCHAR [96] 的指针
                ULONG *session_id);
</code></pre>
<ul>
<li>导出名称：</li>
</ul>
<pre><code>        SbieApi_QueryProcess
</code></pre>
<ul>
<li>参数：</li>
</ul>
<pre><code>        process_id [in] 指定要查询的沙箱进程的 ID。

        box_name [out] 接收进程正在其中运行的沙箱名称。传入 NULL 以忽略此参数。

        image_name [out] 接收进程名称。传入 NULL 以忽略此参数。

        sid_string [out] 接收进程的 SID 字符串。传入 NULL 以忽略此参数。

        session_id [out] 接收进程正在其中运行的登录会话编号。传入 NULL 以忽略此参数。
</code></pre>
<ul>
<li>返回值：</li>
</ul>
<pre><code>        成功时返回零，出错时返回非零值。
</code></pre>
<hr />
<h3 id="_5">终止单个沙箱进程<a class="headerlink" href="#_5" title="Permanent link"></a></h3>
<ul>
<li>原型：</li>
</ul>
<pre><code class="language-C">        typedef BOOLEAN (__stdcall *P_SbieDll_KillOne)(
                HANDLE process_id);
</code></pre>
<ul>
<li>导出名称：</li>
</ul>
<pre><code>        SbieDll_KillOne
</code></pre>
<ul>
<li>参数：</li>
</ul>
<pre><code>        process_id [in] 指定应终止的沙箱进程的进程 ID。
</code></pre>
<ul>
<li>返回值：</li>
</ul>
<pre><code>        成功时返回 TRUE，失败时返回 FALSE。

        目标进程由沙箱服务 (SbieSvc) 通过调用 Windows API TerminateProcess (ProcessId, 1) 以退出代码 1 终止。
</code></pre>
<hr />
<h3 id="_6">终止所有沙箱进程<a class="headerlink" href="#_6" title="Permanent link"></a></h3>
<ul>
<li>原型：</li>
</ul>
<pre><code class="language-C">        typedef BOOLEAN (__stdcall *P_SbieDll_KillAll)(
                ULONG session_id,
                const WCHAR *box_name);
</code></pre>
<ul>
<li>导出名称：</li>
</ul>
<pre><code>        SbieDll_KillAll
</code></pre>
<ul>
<li>参数：</li>
</ul>
<pre><code>        session_id [in] 指定应终止沙箱程序的登录会话编号。

        box_name [in] 指定应终止沙箱程序的沙箱名称。指定 -1 表示当前登录会话。
</code></pre>
<ul>
<li>返回值：</li>
</ul>
<pre><code>        成功时返回 TRUE，失败时返回 FALSE。

        目标进程以上述方式终止；请参阅 SbieDll_KillOne。
</code></pre>
<hr />
<h3 id="sandboxieini">从 Sandboxie.ini 查询配置<a class="headerlink" href="#sandboxieini" title="Permanent link"></a></h3>
<ul>
<li>原型：</li>
</ul>
<pre><code class="language-C">        typedef LONG (__stdcall *P_SbieApi_QueryConf)(
                const WCHAR *section_name,  // 指向 WCHAR [34] 的指针
                const WCHAR *setting_name,  // 指向 WCHAR [66] 的指针
                ULONG setting_index,
                WCHAR *value,
                ULONG value_len)
</code></pre>
<ul>
<li>导出名称：</li>
</ul>
<pre><code>        SbieApi_QueryConf
</code></pre>
<ul>
<li>参数：</li>
</ul>
<pre><code>        section_name [in] 指定包含要查询的设置的节名称。

        setting_name [in] 指定要查询的设置名称。

        setting_index [in] 指定可能多次出现的设置的从零开始的索引编号。该索引编号可以与以下特殊值进行逻辑或运算：

        0x40000000 - 如果指定的设置名称未出现在指定节中，则不扫描 [GlobalSettings] 节。

        0x20000000 - 不展开结果中的任何变量。

        0x10000000 - 忽略源自模板（通常在 Templates.ini 文件中定义）的任何设置。仅查询明确出现在 Sandboxie.ini 文件中的设置。

        value [out] 接收指定设置的值。

        value_len [in] 指定 value 参数指向的缓冲区的最大字节长度。
</code></pre>
<ul>
<li>返回值：</li>
</ul>
<pre><code>        成功时返回零。如果未找到设置，则返回 0xC000008B。任何其他返回值表示其他错误。
</code></pre>
<hr />
<h3 id="sandboxieini_1">更新 Sandboxie.ini 中的配置<a class="headerlink" href="#sandboxieini_1" title="Permanent link"></a></h3>
<ul>
<li>原型：</li>
</ul>
<pre><code class="language-C">        typedef LONG (__stdcall *P_SbieDll_UpdateConf)(
            WCHAR operation_code,
            const WCHAR *password,      // 限制为 64 个字符
                const WCHAR *section_name,  // 限制为 32 个字符
                const WCHAR *setting_name,  // 限制为 64 个字符
                const WCHAR *value)         // 限制为 2000 个字符
</code></pre>
<ul>
<li>导出名称：</li>
</ul>
<pre><code>        SbieDll_UpdateConf
</code></pre>
<ul>
<li>参数：</li>
</ul>
<pre><code>        operation_code [in] 指定如何更新请求的设置：
        's' 表示设置（覆盖），替换任何现有值
        'a' 表示将新值追加到值列表的底部（如果还没有值，则简单设置新值）
        'i' 表示将新值插入到值列表的顶部（如果还没有值，则简单设置新值）
        'd' 表示删除值列表中的现有值

        password [in] 指定如果需要则使用的密码，否则为 NULL 或空字符串。

        section_name [in] 是一个必需参数，指定包含要设置的设置的节名称。

        setting_name [in] 是一个必需参数，指定要设置的设置名称。

        value [ini] 是一个可选参数，指定新值。

        如果 operation_code 为's' 且省略了 value，则指定节中的相应设置将被删除。

        如果 operation_code 为's' 且 setting_name 为 &quot;*&quot;（通配符星号）且省略了 value，则此函数将从配置文件中删除完整的节。
</code></pre>
<ul>
<li>返回值：</li>
</ul>
<pre><code>        成功时返回零。
</code></pre>
<hr />
<h3 id="sandboxieini_2">从 Sandboxie.ini 重新加载配置<a class="headerlink" href="#sandboxieini_2" title="Permanent link"></a></h3>
<ul>
<li>原型：</li>
</ul>
<pre><code class="language-C">        typedef LONG (__stdcall *P_SbieApi_ReloadConf)(
                ULONG session_id);
</code></pre>
<ul>
<li>导出名称：</li>
</ul>
<pre><code>        SbieApi_ReloadConf
</code></pre>
<ul>
<li>参数：</li>
</ul>
<pre><code>        session_id [in] 指定 Sandboxie 将记录任何错误消息的登录会话编号。传递 -1 表示当前登录会话。
</code></pre>
<ul>
<li>返回值：</li>
</ul>
<pre><code>        成功时返回零，出错时返回非零值。
</code></pre>
<hr />
<h3 id="_7">挂钩用户模式入口点<a class="headerlink" href="#_7" title="Permanent link"></a></h3>
<ul>
<li>原型：</li>
</ul>
<pre><code class="language-C">        typedef void *(__stdcall *P_SbieDll_Hook)(
                const char *name,
                void *source_func,
                void *detour_func);
</code></pre>
<ul>
<li>导出名称：</li>
</ul>
<pre><code>        SbieDll_Hook
</code></pre>
<ul>
<li>参数：</li>
</ul>
<pre><code>        name [in] 指定要挂钩的入口点的 ASCII 字符串名称。如果出错，SbieDll_Hook 会记录包含此描述性名称的沙箱错误消息。

        source_func [in] 指向要挂钩的函数的指针。

        detour_func [in] 指向挂钩代码的指针。

        此函数将使源函数调用绕行函数。换句话说，绕行函数将拦截对源函数的所有调用。
</code></pre>
<ul>
<li>返回值：</li>
</ul>
<pre><code>        返回一个函数指针，绕行函数可以使用该指针调用源函数。
</code></pre>
<ul>
<li>示例代码：</li>
</ul>
<pre><code class="language-C">       typedef BOOL (__stdcall *P_DeleteFileW)(const WCHAR *Path);

       P_DeleteFileW pDeleteFileW = NULL;

       BOOL __stdcall MyDeleteFileW(const WCHAR *Path)
        {
            if (Path[0] == L'C') {

                // 静默忽略删除 C 盘上任何文件的请求

                SetLastError(0);
                return TRUE;

            } else {

                // 否则调用原始的 DeleteFileW 函数

                return pDeleteFileW(Path);
            }
        }

        main()
        {
            pDeleteFileW = GetProcAddress(kernel32dll, &quot;DeleteFileW&quot;);
            pDeleteFileW = SbieDll_Hook(&quot;DeleteFile&quot;,
                                        pDeleteFileW,
                                        MyDeleteFileW);
        }
</code></pre>
<hr />
<h3 id="dll">注册 DLL 加载/卸载回调<a class="headerlink" href="#dll" title="Permanent link"></a></h3>
<ul>
<li>原型：</li>
</ul>
<pre><code class="language-C">       typedef void (__stdcall *P_DllCallback)(const WCHAR *ImageName, HMODULE ImageBase);
</code></pre>
<pre><code class="language-C">       typedef BOOLEAN *(__stdcall *P_SbieDll_RegisterDllCallback)(
               P_DllCallback pCallback);
</code></pre>
<ul>
<li>导出名称：</li>
</ul>
<pre><code>       SbieDll_RegisterDllCallback

       此 API 从 Sandboxie 3.46 版本开始可用。
</code></pre>
<ul>
<li>参数：</li>
</ul>
<pre><code>       pCallback 指定一个回调函数，每当进程中加载或卸载任何 DLL 时都会调用该回调函数。该回调函数无法注销。
</code></pre>
<pre><code>       回调函数的 ImageName（第一个）参数指定已加载或卸载的 DLL 的 UNICODE 名称字符串。该名称字符串不包含路径。
</code></pre>
<pre><code>       回调函数的 ImageBase（第二个）参数指定 DLL 加载时的加载基地址。当调用回调函数通知 DLL 卸载时，此参数设置为零。
</code></pre>
<ul>
<li>返回值：</li>
</ul>
<pre><code>       成功时返回 TRUE，如果无法注册回调则返回 FALSE。从 3.46 版本开始，Sandboxie 支持在单个进程中最多进行 8 次注册。
</code></pre>
<hr />
<h3 id="sandboxie">获取 Sandboxie 主文件夹<a class="headerlink" href="#sandboxie" title="Permanent link"></a></h3>
<ul>
<li>原型：</li>
</ul>
<pre><code class="language-C">       typedef LONG *(__stdcall *P_SbieApi_GetHomePath)(
               WCHAR *NtPath,
               ULONG NtPathMaxLen,
               WCHAR *DosPath,
               ULONG DosPathMaxLen);
</code></pre>
<ul>
<li>导出名称：</li>
</ul>
<pre><code>       SbieApi_GetHomePath

       此 API 从 Sandboxie 3.52 版本开始可用。
</code></pre>
<ul>
<li>参数：</li>
</ul>
<pre><code>       NtPath 指定一个指向缓冲区的指针，该缓冲区将接收 Sandboxie 安装文件夹的完整 NT 路径语法的路径。

       NtPathMaxLen 指定 NtPath 缓冲区的大小。将 NtPath 指定为 NULL 并将 NtPathMaxLen 指定为零以不接收 NT 路径。

       DosPath 指定一个指向缓冲区的指针，该缓冲区将接收 Sandboxie 安装文件夹的完整 DOS 路径语法的路径。

       DosPathMaxLen 指定 DosPath 缓冲区的大小。将 DosPath 指定为 NULL 并将 DosPathMaxLen 指定为零以不接收 NT 路径。
</code></pre>
<ul>
<li>返回值：</li>
</ul>
<pre><code>       成功时返回零，出错时返回非零值。

       STATUS_BUFFER_TOO_SMALL (0xC0000023) 表示 NtPathMaxLen 或 DosPathMaxLen 指定的缓冲区太小。增大输入缓冲区的大小并重新尝试调用。
</code></pre>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="页脚" >
        
          
          <a href="../SBIEMessages/" class="md-footer__link md-footer__link--prev" aria-label="上一页: SBIE 消息">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                上一页
              </span>
              <div class="md-ellipsis">
                SBIE 消息
              </div>
            </div>
          </a>
        
        
          
          <a href="../SBIE1101/" class="md-footer__link md-footer__link--next" aria-label="下一页: SBIE1101">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                下一页
              </span>
              <div class="md-ellipsis">
                SBIE1101
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      This site is maintained by <a href="https://github.com/sandboxie-plus">sandboxie-plus</a>. If you wish to contribute: <a href="https://github.com/sandboxie-plus/sandboxie-docs">Improve sandboxie-docs!</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="https://github.com/sandboxie-plus/sandboxie-docs" target="_blank" rel="noopener" title="Sandboxie Documentation on Github" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../../material/assets/javascripts/extra.js"></script>
      
    
  </body>
</html>
