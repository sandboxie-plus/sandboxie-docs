# 检测键盘记录器

转到[帮助主题](HelpTopics.md)、[使用技巧](UsageTips.md)。

* * *

### 概述

可靠地检测所有类型的键盘记录器非常困难。本节首先解释原因，最后提供可能的防御措施。

首先，必须区分几种类型的键盘记录器：

* 外部键盘记录器
* Rootkit 键盘记录器
* Windows 钩子键盘记录器
* Windows 消息键盘记录器
* 脚本键盘记录器

### 外部键盘记录器

外部（或硬件）键盘记录器是以某种方式连接到计算机的设备。两个例子是：插在键盘和计算机之间的小型设备，或监听无线键盘传输的无线电信号的设备。

这类键盘记录器的共同原则是它们位于被监视的 Windows 系统_外部_。在 Windows 内运行的软件无法检测、移除或防范外部键盘记录器。

这里描述的其他类型的键盘记录器是在 Windows 内运行的软件键盘记录器。

### Rootkit 键盘记录器

Rootkit 键盘记录器在最低软件级别记录击键，通常通过将自己定位为第二个键盘硬件驱动程序（在 Windows 术语中称为_过滤器_驱动程序）。

一旦安装，这类键盘记录器可能提供最好的记录功能，并且可能难以摆脱。但要首先安装，这种键盘记录器需要操作系统的明确帮助，因此很容易被 Sandboxie 阻止。

~~如果此类键盘记录器尝试安装，Sandboxie 应该报告信息消息 [SBIE2103](SBIE2103.md)，除非明确使用 [BlockDrivers](BlockDrivers.md) 设置（另见[沙盒设置 > 限制 > 低级访问](RestrictionsSettings.md#low-level-access--removed)）来禁用此保护。~~

### Windows 钩子键盘记录器

这些键盘记录器不伪装成硬件驱动程序，但它们仍然需要请求操作系统将它们加载（或_钩入_）到在桌面上执行的每个程序中。

应用程序在正常操作过程中安装此类钩子并不罕见，阻止所有钩子会阻止某些程序在沙盒内成功运行。

~~**已从 Sandboxie 中移除 - 阻止钩子命令**~~

~~Sandboxie 采取的方法是部分接受钩子请求，只将钩子应用于与请求应用程序在同一沙盒中的应用程序。~~

~~可以使用 [BlockWinHooks](BlockWinHooks.md) 设置（另见[沙盒设置 > 限制 > 低级访问](RestrictionsSettings.md#low-level-access--removed)）来明确禁用此保护。~~

### Windows 消息键盘记录器

这类键盘记录器不需要操作系统的任何帮助，只能可靠地记录一个程序内的活动。然而，从像 Sandboxie 这样的监督程序的角度来看，它们不会做任何可疑的事情，因此无法被阻止。

为了让在桌面上运行的程序实际处理键盘输入，操作系统会向该程序发送描述输入的消息。消息键盘记录器可能在与被记录程序相同的进程空间中运行，可以通过各种方式监听这些消息，这些方式不会引起怀疑。

通常，这种键盘记录器会是一个秘密的 Web 浏览器插件（或插件的秘密组件），因此它可以轻松记录与 Web 浏览器相关的键盘活动。

### 脚本键盘记录器

这类键盘记录器针对并危害您将要访问的网站。这与这里讨论的其他三种键盘记录器形成对比，后者针对并危害您自己的计算机。

JavaScript 和 VBScript 语言提供了让网页对击键做出反应的功能。这些功能的合法用途使创建复杂的网页成为可能。例如，考虑 Google 和 Yahoo! 搜索如何对您输入的键做出反应以建议可能的搜索字符串。

通过利用网站的安全弱点，间谍将脚本键盘记录器嵌入到网站的某个页面中。这些键盘记录器实际上与同一网站上的其他脚本无法区分，可以使用相同的脚本功能对您的击键做出反应、记录它们或将它们传输到第三方网站。

### 防御键盘记录器

Sandboxie 不是设计用来检测或禁用键盘记录器的，但它设计用来确保沙盒软件保持在沙盒内，确保此类软件无法集成到 Windows 中，并确保在删除沙盒时可以完全丢弃它。

这意味着，如果您注意在沙盒中执行所有不可信的活动，您始终可以删除沙盒以撤销该活动的效果，并将计算机恢复到可信状态。

第一步是确保在使用 Sandboxie 之前，您的系统没有被恶意键盘记录器感染。防病毒或反恶意软件工具的系统扫描应该对此有所帮助。

然后在沙盒的限制区域内执行所有不可信的活动——如浏览网页、阅读电子邮件和测试未知程序。这并不意味着您不会被键盘记录器感染，但这确实意味着您可以摆脱它们：

* 您可以通过告诉 Sandboxie 停止所有沙盒中的所有活动来确保停止所有键盘记录器。
  * 另见[文件菜单](FileMenu.md#terminate-all-programs)和[托盘图标菜单](TrayIconMenu.md#terminate-all-programs)中的**终止所有程序**命令。
* 一旦停止，您可以通过删除沙盒的内容来丢弃它们的程序代码痕迹。
  * 另见[删除沙盒](DeleteSandbox.md)。

一旦丢弃，它们就无法再记录您的键盘活动，您可以安全地浏览可信网站并输入密码。

请注意，如果您不喜欢定期删除沙盒，您可以为可信浏览设置一个沙盒，并在执行可信活动之前只删除该沙盒。但为了最大程度的保护，首先停止所有沙盒中的所有沙盒活动仍然很重要。

* * *

另一种防御键盘记录器的措施是配置 Sandboxie 拒绝除 Web 浏览器之外的任何程序访问互联网，以尝试防止键盘记录器发送记录的信息。参见[程序设置](ProgramSettings.md#internet)中"唯一可以访问互联网的程序"的设置。

注意两个注意事项：

* 互联网访问功能既不能替代适当的防火墙，也不是设计用来对抗或阻碍键盘记录器的机制。

* 某些键盘记录器可能通过劫持 Web 浏览器作为发送记录信息的工具来规避互联网访问限制。

* * *

转到[帮助主题](HelpTopics.md)、[使用技巧](UsageTips.md)。 